# <div align="center"><img src="img/icon.png" width="120" alt="å¤¸å…‹è‡ªåŠ¨è½¬å­˜åŠ©æ‰‹"></div>

## <div align="center">å¤¸å…‹è‡ªåŠ¨è½¬å­˜åŠ©æ‰‹</div>

<div align="center">

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„å¤¸å…‹ç½‘ç›˜è‡ªåŠ¨è½¬å­˜å·¥å…·ï¼Œæ”¯æŒå®šæ—¶è¿½æ›´ã€æ™ºèƒ½é‡å‘½åã€æ’ä»¶æ‰©å±•ç­‰åŠŸèƒ½ã€‚

[![Python](https://img.shields.io/badge/Python-3.6+-blue.svg)](https://www.python.org/)
[![Flask](https://img.shields.io/badge/Flask-2.0+-green.svg)](https://flask.palletsprojects.com/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![GitHub stars](https://img.shields.io/github/stars/Cp0204/quark_auto_save.svg)](https://github.com/Cp0204/quark_auto_save)

</div>

## âœ¨ ä¸»è¦ç‰¹æ€§

### ğŸ” è‡ªåŠ¨è½¬å­˜ä¸è¿½æ›´
- **æ™ºèƒ½ç›‘æ§**ï¼šè‡ªåŠ¨ç›‘æ§å¤¸å…‹åˆ†äº«é“¾æ¥ï¼ŒåŠæ—¶è½¬å­˜æ–°å†…å®¹
- **å¢é‡æ›´æ–°**ï¼šä»…è½¬å­˜æ–°å¢æ–‡ä»¶ï¼Œé¿å…é‡å¤æ“ä½œ
- **æ‰¹é‡ç®¡ç†**ï¼šæ”¯æŒå¤šä»»åŠ¡å¹¶è¡Œå¤„ç†

### ğŸ¯ æ™ºèƒ½è¿‡æ»¤ä¸é‡å‘½å
- **æ­£åˆ™åŒ¹é…**ï¼šå¼ºå¤§çš„æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…åŠŸèƒ½
- **é­”æ³•é‡å‘½å**ï¼šæ”¯æŒå¤šç§å˜é‡æ›¿æ¢ï¼ˆé›†æ•°ã€å­£æ•°ã€æ—¥æœŸç­‰ï¼‰
- **æ™ºèƒ½æ’åº**ï¼šè‡ªåŠ¨æ–‡ä»¶æ’åºï¼Œç¡®ä¿å‘½åä¸€è‡´æ€§
- **æ‰©å±•åå¤„ç†**ï¼šå¯é…ç½®å¿½ç•¥æ‰©å±•åè¿›è¡Œé‡å¤æ£€æµ‹

### ğŸŒ Web ç®¡ç†ç•Œé¢
- **å¯è§†åŒ–é…ç½®**ï¼šç›´è§‚çš„ Web ç•Œé¢ç®¡ç†ä»»åŠ¡
- **å®æ—¶ç›‘æ§**ï¼šæŸ¥çœ‹è½¬å­˜è¿›åº¦å’Œæ‰§è¡Œæ—¥å¿—
- **å®šæ—¶ä»»åŠ¡**ï¼šåŸºäº APScheduler çš„å®šæ—¶ä»»åŠ¡è°ƒåº¦
- **è¿œç¨‹ç®¡ç†**ï¼šæ”¯æŒè¿œç¨‹è®¿é—®å’Œæ§åˆ¶

### ğŸ”Œ æ’ä»¶ç³»ç»Ÿ
- **æ‰©å±•æ¶æ„**ï¼šæ”¯æŒè‡ªå®šä¹‰æ’ä»¶æ‰©å±•åŠŸèƒ½
- **ä¸°å¯Œæ’ä»¶**ï¼šå†…ç½® Embyã€Plexã€AList ç­‰å¤šç§æ’ä»¶
- **çƒ­æ’æ‹”**ï¼šæ”¯æŒæ’ä»¶åŠ¨æ€åŠ è½½å’Œé…ç½®
- **ä¼˜å…ˆçº§æ§åˆ¶**ï¼šå¯é…ç½®æ’ä»¶æ‰§è¡Œä¼˜å…ˆçº§

### ğŸ“± å¤šå¹³å°æ”¯æŒ
- **é’é¾™é¢æ¿**ï¼šå®Œç¾é€‚é…é’é¾™å®šæ—¶ä»»åŠ¡
- **Docker**ï¼šæä¾› Docker é•œåƒéƒ¨ç½²
- **æœ¬åœ°è¿è¡Œ**ï¼šæ”¯æŒ Windowsã€Linuxã€macOS
- **äº‘æœåŠ¡å™¨**ï¼šæ”¯æŒå„ç§äº‘æœåŠ¡å™¨ç¯å¢ƒ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.6+
- pip åŒ…ç®¡ç†å™¨

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/Cp0204/quark_auto_save.git
cd quark_auto_save
```

2. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

3. **é…ç½®æ–‡ä»¶**
```bash
# é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ä¸‹è½½é…ç½®æ¨¡æ¿
python quark_auto_save.py
```

4. **ç¼–è¾‘é…ç½®**
ç¼–è¾‘ `quark_config.json` æ–‡ä»¶ï¼Œé…ç½®æ‚¨çš„å¤¸å…‹ Cookie å’Œè½¬å­˜ä»»åŠ¡ï¼š

```json
{
  "cookie": "æ‚¨çš„å¤¸å…‹Cookie",
  "push_config": {
    "CONSOLE": true
  },
  "tasklist": [
    {
      "taskname": "ç¤ºä¾‹ä»»åŠ¡",
      "shareurl": "https://pan.quark.cn/s/xxxxxxxx",
      "savepath": "/è‡ªåŠ¨è½¬å­˜",
      "pattern": ".*\\.(mp4|mkv|avi)",
      "replace": "{TASKNAME} - S{SXX}E{E}.{EXT}"
    }
  ]
}
```

### é’é¾™é¢æ¿éƒ¨ç½²

1. **æ·»åŠ ä»“åº“**
```bash
ql repo https://github.com/Cp0204/quark_auto_save.git "quark_auto_save"
```

2. **è®¾ç½®å®šæ—¶ä»»åŠ¡**
```
0 8,18,20 * * * quark_auto_save.py
```

3. **é…ç½®ç¯å¢ƒå˜é‡**
- `QUARK_COOKIE`: å¤¸å…‹ Cookieï¼ˆä»…ç­¾åˆ°ï¼‰
- `QUARK_TEST`: è®¾ç½®ä¸º "true" è¿›è¡Œé€šçŸ¥æµ‹è¯•

### Docker éƒ¨ç½²

```bash
docker run -d \
  --name quark-auto-save \
  -v $(pwd)/config:/app/config \
  -p 5000:5000 \
  cp0204/quark-auto-save:latest
```

## ğŸ“– è¯¦ç»†é…ç½®

### Cookie è·å–

1. ç™»å½• [å¤¸å…‹ç½‘ç›˜](https://pan.quark.cn/)
2. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
3. åˆ·æ–°é¡µé¢ï¼Œåœ¨ Network æ ‡ç­¾æ‰¾åˆ°è¯·æ±‚
4. å¤åˆ¶è¯·æ±‚å¤´ä¸­çš„ `Cookie` å­—æ®µ

### ä»»åŠ¡é…ç½®å‚æ•°

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `taskname` | string | âœ… | ä»»åŠ¡åç§° |
| `shareurl` | string | âœ… | å¤¸å…‹åˆ†äº«é“¾æ¥ |
| `savepath` | string | âœ… | ä¿å­˜è·¯å¾„ |
| `pattern` | string | âŒ | æ­£åˆ™åŒ¹é…æ¨¡å¼ |
| `replace` | string | âŒ | é‡å‘½åæ¨¡æ¿ |
| `startfid` | string | âŒ | èµ·å§‹æ–‡ä»¶ID |
| `enddate` | string | âŒ | ä»»åŠ¡ç»“æŸæ—¥æœŸ |
| `runweek` | array | âŒ | è¿è¡Œæ˜ŸæœŸ |
| `ignore_extension` | boolean | âŒ | å¿½ç•¥æ‰©å±•åæ£€æµ‹ |

### é­”æ³•å˜é‡è¯´æ˜

| å˜é‡ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `{TASKNAME}` | ä»»åŠ¡åç§° | `æˆ‘çš„å‰§é›†` |
| `{S}` | å­£æ•°ï¼ˆå•æ•°å­—ï¼‰ | `1` |
| `{SXX}` | å­£æ•°ï¼ˆåŒæ•°å­—ï¼‰ | `S01` |
| `{E}` | é›†æ•° | `05` |
| `{DATE}` | æ—¥æœŸ | `2024-01-01` |
| `{YEAR}` | å¹´ä»½ | `2024` |
| `{EXT}` | æ–‡ä»¶æ‰©å±•å | `mp4` |
| `{I+}` | åºå·å ä½ç¬¦ | `001, 002, 003` |

## ğŸ”Œ æ’ä»¶å¼€å‘

### æ’ä»¶æ¥å£

```python
class YourPlugin:
    def __init__(self, **config):
        self.default_config = {
            "enabled": True
        }
        self.config = {**self.default_config, **config}
        self.is_active = self.config.get("enabled", False)

    def run(self, task, account=None, tree=None):
        # æ’ä»¶é€»è¾‘å¤„ç†
        return task
```

### å†…ç½®æ’ä»¶

- **Emby**: è‡ªåŠ¨åˆ·æ–° Emby åª’ä½“åº“
- **Plex**: è‡ªåŠ¨æ›´æ–° Plex æœåŠ¡å™¨
- **AList**: åŒæ­¥æ–‡ä»¶åˆ° AList
- **WebHook**: å‘é€ WebHook é€šçŸ¥

## ğŸ“Š Web ç®¡ç†ç•Œé¢

è®¿é—® `http://localhost:5000` è¿›å…¥ Web ç®¡ç†ç•Œé¢ï¼š

- **ä»»åŠ¡ç®¡ç†**: æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤è½¬å­˜ä»»åŠ¡
- **æ‰§è¡Œæ—¥å¿—**: æŸ¥çœ‹è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—
- **ç³»ç»ŸçŠ¶æ€**: ç›‘æ§ç³»ç»Ÿè¿è¡ŒçŠ¶æ€
- **é…ç½®ç®¡ç†**: åœ¨çº¿ç¼–è¾‘é…ç½®æ–‡ä»¶

## ğŸ”§ é«˜çº§åŠŸèƒ½

### å®šæ—¶ä»»åŠ¡é…ç½®

ä½¿ç”¨ APScheduler æ”¯æŒå¤šç§å®šæ—¶æ–¹å¼ï¼š

```python
# æ¯å¤©å®šæ—¶æ‰§è¡Œ
scheduler.add_job(task_function, 'cron', hour=8, minute=0)

# é—´éš”æ‰§è¡Œ
scheduler.add_job(task_function, 'interval', hours=2)

# ä¸€æ¬¡æ€§æ‰§è¡Œ
scheduler.add_job(task_function, 'date', run_date='2024-01-01 10:00:00')
```

### é€šçŸ¥é…ç½®

æ”¯æŒå¤šç§é€šçŸ¥æ–¹å¼ï¼š

```json
{
  "push_config": {
    "CONSOLE": true,
    "SERVERCHAN": "æ‚¨çš„ ServerChan Key",
    "BARK": "æ‚¨çš„ Bark Token",
    "TG_BOT_TOKEN": "æ‚¨çš„ Telegram Bot Token",
    "TG_USER_ID": "æ‚¨çš„ Telegram User ID"
  }
}
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Cookie å¤±æ•ˆ**
   - é‡æ–°è·å–å¤¸å…‹ Cookie
   - æ£€æŸ¥ Cookie æ ¼å¼æ˜¯å¦æ­£ç¡®

2. **è½¬å­˜å¤±è´¥**
   - æ£€æŸ¥åˆ†äº«é“¾æ¥æ˜¯å¦æœ‰æ•ˆ
   - ç¡®è®¤ä¿å­˜è·¯å¾„æ˜¯å¦æœ‰æƒé™

3. **ä»»åŠ¡ä¸æ‰§è¡Œ**
   - æ£€æŸ¥è¿è¡Œå‘¨æœŸé…ç½®
   - ç¡®è®¤æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦æ­£ç¡®

### æ—¥å¿—åˆ†æ

ç¨‹åºè¿è¡Œæ—¥å¿—åŒ…å«è¯¦ç»†ä¿¡æ¯ï¼š

```bash
# æŸ¥çœ‹å®Œæ•´æ—¥å¿—
python quark_auto_save.py

# æŸ¥çœ‹ç‰¹å®šä»»åŠ¡
grep "ä»»åŠ¡åç§°" logs/quark_auto_save.log
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯å¼€æº - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [Quark](https://pan.quark.cn/) - å¤¸å…‹ç½‘ç›˜æœåŠ¡
- [Flask](https://flask.palletsprojects.com/) - Web æ¡†æ¶
- [APScheduler](https://apscheduler.readthedocs.io/) - ä»»åŠ¡è°ƒåº¦
- [treelib](https://treelib.readthedocs.io/) - æ ‘å½¢æ•°æ®ç»“æ„

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µ: [GitHub](https://github.com/Cp0204/quark_auto_save)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/Cp0204/quark_auto_save/issues)
- è®¨è®ºäº¤æµ: [Discussions](https://github.com/Cp0204/quark_auto_save/discussions)

---

<div align="center">
  <p>å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ï¸ æ”¯æŒä¸€ä¸‹ï¼</p>
  <p>Made with â¤ï¸ by Cp0204</p>
</div>